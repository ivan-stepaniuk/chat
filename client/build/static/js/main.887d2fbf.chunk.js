(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{111:function(e,t,a){e.exports=a(170)},116:function(e,t,a){},159:function(e,t){},170:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(9),l=a.n(o),s=(a(116),a(33)),i=a(34),c=a(38),u=a(25),m=a(26),d=a(29),h=a(27),g=a(20),p=a(30),f=a(204),E=a(212),b=a(206),v=a(205),y=a(46),w=a(199),j=a(21),C=a.n(j),O=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).signInRequest=a.signInRequest.bind(Object(g.a)(a)),a.handleInputChange=a.handleInputChange.bind(Object(g.a)(a)),a.state={authorized:!1,user:C.a.auth().currentUser},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"handleInputChange",value:function(e){var t=e.target,a=t.value,n=t.name;this.setState(Object(c.a)({},n,a))}},{key:"signInRequest",value:function(e){var t=this;e.preventDefault(),C.a.auth().signInWithEmailAndPassword(this.state.email,this.state.password).then((function(e){L.collection("users").doc(e.user.uid).get().then((function(e){var t=e.data();t&&(window.localStorage.setItem("authorized",!0),window.localStorage.setItem("name",t.name),window.location.href="/chat")}))})).catch((function(e){t.setState({error:e.message})}))}},{key:"goToChat",value:function(){window.location.href="/chat"}},{key:"render",value:function(){return this.state.user?r.a.createElement(i.a,{to:"/chat"}):r.a.createElement(w.a,{component:"main",maxWidth:"xs"},r.a.createElement("p",null,this.state.error),r.a.createElement("div",null,r.a.createElement(y.a,{component:"h1",variant:"h5",align:"center"},"Login"),r.a.createElement("br",null),r.a.createElement("form",{onSubmit:this.signInRequest},r.a.createElement(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",type:"email",autoComplete:"email",autoFocus:!0,onChange:this.handleInputChange}),r.a.createElement(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:this.handleInputChange}),r.a.createElement(f.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary"},"Sign In"),r.a.createElement(v.a,{container:!0},r.a.createElement(v.a,{item:!0},r.a.createElement(b.a,{href:"/signup",variant:"body2"},"Don't have an account? Sign Up"))))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"align-center"},r.a.createElement("p",null,"or you can chat as anonymous"),r.a.createElement(f.a,{variant:"outlined",color:"primary",onClick:this.goToChat},"Go to chat")))}}]),t}(r.a.Component),I=a(207),k=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={},a.signUpRequest=a.signUpRequest.bind(Object(g.a)(a)),a.handleInputChange=a.handleInputChange.bind(Object(g.a)(a)),a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"signUpRequest",value:function(e){var t=this;e.preventDefault(),C.a.auth().createUserWithEmailAndPassword(this.state.email,this.state.password).then((function(e){L.collection("users").doc(e.user.uid).set({name:t.state.name}).then((function(){window.location.href="/login"}))}),(function(e){t.setState({error:e.message})}))}},{key:"handleInputChange",value:function(e){var t=e.target,a=t.value,n=t.name;this.setState(Object(c.a)({},n,a))}},{key:"render",value:function(){return r.a.createElement(w.a,{component:"main",maxWidth:"xs"},r.a.createElement("p",null,this.state.error),r.a.createElement(I.a,null),r.a.createElement("div",null,r.a.createElement(y.a,{component:"h1",variant:"h5"},"Sign up"),r.a.createElement("br",null),r.a.createElement("form",{noValidate:!0,onSubmit:this.signUpRequest},r.a.createElement(v.a,{container:!0,spacing:2},r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(E.a,{variant:"outlined",required:!0,fullWidth:!0,id:"text",label:"Your name",name:"name",onChange:this.handleInputChange})),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(E.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",onChange:this.handleInputChange})),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(E.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:this.handleInputChange}))),r.a.createElement("br",null),r.a.createElement(f.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary"},"Sign Up"),r.a.createElement(v.a,{container:!0,justify:"flex-end"},r.a.createElement(v.a,{item:!0},r.a.createElement(b.a,{href:"/login",variant:"body2"},"Already have an account? Sign in"))))))}}]),t}(r.a.Component),S=a(98),N=a(96),z=a.n(N),q=a(203),W=a(210),x=a(211),B=a(97),U=a(95),D=a(208),M=a(209),R=Object(U.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function T(e){var t=R(),a=r.a.useState(e.authorized),n=Object(B.a)(a,1)[0];return r.a.createElement("div",{className:t.root},r.a.createElement(D.a,{position:"static"},r.a.createElement(M.a,null,r.a.createElement(y.a,{variant:"h6",className:t.title},e.title),n&&r.a.createElement(y.a,null," Your are logged in as ",e.userName),r.a.createElement(f.a,{variant:"contained",color:"default"},n?r.a.createElement(s.b,{to:"/logout"},"logout"):r.a.createElement(s.b,{to:"/login"},"login")),n&&r.a.createElement(f.a,{variant:"contained",color:"default"}," ",r.a.createElement(s.b,{to:"/history"},"history")," "),n&&r.a.createElement(f.a,{variant:"contained",color:"default"}," ",r.a.createElement(s.b,{to:"/chat"},"Chat")," "))))}var A=a(58),P=a(59),J=a.n(P),F=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).sendMessage=a.sendMessage.bind(Object(g.a)(a)),a.handleInputChange=a.handleInputChange.bind(Object(g.a)(a)),a.socket=z.a.connect("http://localhost:5000"),a.getMessages().then((function(e){a.setState({messages:e.reverse()})})),a.socket.on("chat message",(function(e){var t=JSON.parse(e);a.setState((function(e){return{messages:[].concat(Object(S.a)(e.messages),[t])}}))})),a.state={messages:[],userName:window.localStorage.getItem("name"),authorized:window.localStorage.getItem("authorized")},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"scrollToBottom",value:function(){A.animateScroll.scrollToBottom({containerId:"messages-block"})}},{key:"getMessages",value:function(){return L.collection("messages").orderBy("date","desc").limit(30).get().then((function(e){return e.docs.map((function(e){return e.data()}))}))}},{key:"handleInputChange",value:function(e){var t=e.target,a=t.value,n=t.name;this.setState(Object(c.a)({},n,a))}},{key:"sendMessage",value:function(){var e={name:this.state.authorized?this.state.userName:null,message:this.state.msg,date:new Date};this.socket.emit("chat message",JSON.stringify(e))}},{key:"render",value:function(){var e=this.state.messages;return r.a.createElement("div",null,r.a.createElement(T,{userName:this.state.userName,authorized:this.state.authorized,title:"Chat"}),r.a.createElement(q.a,{id:"messages-block",className:"messages-block"},e.map((function(e){return r.a.createElement(W.a,null,r.a.createElement("span",null),r.a.createElement(x.a,{primary:e.message,secondary:"by ".concat(e.name||"anonymous","  ").concat(J()(e.date).fromNow())}))}))),r.a.createElement("div",{className:"footer"},r.a.createElement("div",null,r.a.createElement(E.a,{className:"message-input",fullWidth:!0,label:"Type here your message...",name:"msg",onChange:this.handleInputChange,autoFocus:!0,autocomplete:!1}),r.a.createElement(f.a,{variant:"outlined",className:"send-button",onClick:this.sendMessage},"Send"))))}}]),t}(r.a.Component);var G=function(){return C.a.auth().signOut().then((function(){window.localStorage.clear(),window.location.href="/login"})).catch((function(e){}))},K=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).getMessages().then((function(e){a.setState({messages:e.reverse()})})),window.localStorage.getItem("authorized")||(window.location.href="/login"),a.state={messages:[],userName:window.localStorage.getItem("name"),authorized:window.localStorage.getItem("authorized")},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"scrollToBottom",value:function(){A.animateScroll.scrollToBottom({containerId:"messages-block"})}},{key:"getMessages",value:function(){return L.collection("messages").orderBy("date","desc").get().then((function(e){return e.docs.map((function(e){return e.data()}))}))}},{key:"render",value:function(){var e=this.state.messages;return r.a.createElement("div",null,r.a.createElement(T,{userName:this.state.userName,authorized:this.state.authorized,title:"History"}),r.a.createElement(q.a,{id:"messages-block",className:"messages-block history"},e.map((function(e){return r.a.createElement(W.a,null,r.a.createElement("span",null),r.a.createElement(x.a,{primary:e.message,secondary:"by ".concat(e.name||"anonymous","  ").concat(J()(e.date).fromNow())}))}))))}}]),t}(r.a.Component);a.d(t,"db",(function(){return L})),C.a.initializeApp({apiKey:"AIzaSyD1voPHoDLS-wXsE5KX1p5DXOWUCKPF19U",authDomain:"testproject-fcaaf.firebaseapp.com",databaseURL:"https://testproject-fcaaf.firebaseio.com",projectId:"testproject-fcaaf",storageBucket:"testproject-fcaaf.appspot.com",messagingSenderId:"12418952429",appId:"1:12418952429:web:dc4d7c09460dd1ba40b0e4"});var L=C.a.firestore();l.a.render(r.a.createElement((function(){return r.a.createElement(s.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/login"},r.a.createElement(O,null)),r.a.createElement(i.b,{path:"/signup"},r.a.createElement(k,null)),r.a.createElement(i.b,{path:"/logout"},r.a.createElement(G,null)),r.a.createElement(i.b,{path:"/history"},r.a.createElement(K,null)),r.a.createElement(i.b,{path:"/"},r.a.createElement(F,null))))}),null),document.getElementById("root"))}},[[111,1,2]]]);
//# sourceMappingURL=main.887d2fbf.chunk.js.map